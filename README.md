# Django Web Scraper Service  (OpenMedia Testcase)

## Техническое задание

Этот проект представляет собой веб-сервис на Django, который выполняет следующие функции:

### API Методы:

1. **POST** `/page/create`
   - Параметры: `url` (произвольная веб-страница).
   - Описание: Парсинг страницы по переданному URL, извлечение всех заголовков h1, h2, h3, и ссылок. Результат сохраняется в базе данных, и возвращается уникальный идентификатор созданного объекта.

2. **GET** `/page/{object_id}`
   - Параметры: `object_id` (уникальный идентификатор объекта).
   - Описание: По идентификатору возвращается JSON с количеством найденных HTML-элементов и списком ссылок. Пример ответа:
     ```json
     {
       "h1": 1,
       "h2": 2,
       "h3": 3,
       "a": ["link1", "link2"]
     }
     ```

3. **GET** `/page/list`
   - Параметры: `order` (опционально).
   - Описание: Возвращает список страниц с информацией аналогичной пункту 2. Поддерживается сортировка по количеству заголовков `h1`, `h2`, `h3`. Если параметр не передан — сортировка по времени создания.

4. **GET** `/page/list?order=h1`
   - Описание: Сортировка по количеству элементов `h1` в порядке убывания.

5. **GET** `/page/list?order=-h2`
   - Описание: Сортировка по количеству элементов `h2` в порядке возрастания.

### Дополнительно:
- Реализована документация через **Swagger** и **ReDoc** для удобства работы с API.
- CI состоящий из линтеров и тестов (при git pull/ git push работает пайплайн на линтеры и тесты)


### Запуск
```
git clone https://github.com/ant0ndk/openmedia_test.git
cd openmedia_test
```

Далее запишите в .env файл свои данные
```
DB_NAME - имя бд
DB_USER - логин для бд
DB_PASSWORD - пароль для бд
DB_HOST - хост для бд
DB_PORT - порт для бд
SECRET_KEY - секретный ключ для django
```

#### Для запуска локально:
```
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt
cd web
python manage.py migrate
python manage.py runserver
```

#### Запуск в docker
```
docker compose up --build
```